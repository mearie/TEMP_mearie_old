## vim: syn=mako
<%inherit file="../../entry.tmpl.html"/>
<%!
title = u'짜증나는 메가패스'
when = '2008-09-27T14:13:21+09:00'
tags = [u'인터넷 서비스', u'메가패스', u'삽질']
original = 'http://mearie.org/journal/2008/09/megapass-makes-me-angry'
%>

저번에 아버지께서 메가TV 같은 쓸데 없는 사탕발림에 넘어 가신 덕분에 인터넷 서비스를 하나로에서 메가패스로 갈아 치운 뒤로 내 KT에 대한 증오는 날로 커져만 간다. 옛날에 공유기 쓸 때만 해도 안 이랬는데 네트워크 구조를 한 번 크게 바꾼 이후로는 정말 인터넷 연결이 거지같아서 짜증이 난다.


네트워크 구조
-------------

현재 집에는 어떤 식으로든 네트워크에 연결되는 장치가 여덟(!) 개가 있고, 그 목록은 다음과 같다.

* lifthrasiir 씨의 옛 노트북 — 일명 썰매. 호스트명 blueish.mearie.org
* lifthrasiir 씨의 새 노트북 (맥북 프로) — 호스트명 entangle.mearie.org
* 동생 노트북
* 거실 데스크탑
* 무선랜 공유기 — 한 때 집의 주 공유기로 사용했으나 열을 너무 많이 받아서 자주 뻗는다.
* [메가TV](http://mymegatv.com/) 수신기 — 이 수신기는 구조적으로 거실 데스크탑 자리에 연결해서 쓸 수 있는 공유기로 동작한다.
* lifthrasiir 씨 방에 있는 4포트 허브
* 집 바깥으로 나가는 허브

써 보니까 무지 많다. (이러니 전기세가…) 실질적으로 IP를 가지는 것은 허브 두 개를 뺀 여섯 개이고, 바깥에서 보이는 것은 공유기를 거치지 않는 내 노트북 두 대와 동생 노트북, 그리고 메가TV 수신기가 되겠다. 여기서 문제가 생긴다.

메가패스가 도입한 신인증(도대체 이게 뭐가 좋아서 "신"인지 모르겠다.)은 매번 인터넷에 연결될 때마다 모든 HTTP 연결을 가로채서 (DNS 단계인지 패킷 스푸핑인지는 모르겠다.) 로그인 페이지로 재지정시키고, 거기서 아이디와 암호를 입력하면 그 때부터 락을 모두 풀어 버리는 식이다. 옛날에 무선랜 공유기를 주 공유기로 사용할 때만 해도 아이피가 바뀌는 일은 사실상 없었기 때문에 문제가 없었지만, 허브로 바뀐 이후로는 모든 컴퓨터마다 아이피가 따로 부여되기 때문에 문제가 좀 심각해졌다.

뭐 일단 윈도, 리눅스, 맥 모두 페이지에 접속해서 아이디 암호 입력하고 나중에는 기억까지 해 주는 걸 보면 욕을 많이 들어 먹긴 했구나 하는 생각이 들었다. 그런데 문제는 썰매다.

<p class="center">**이 썰매 노트북은 화면이 안 나온다. -_-;;;;;**</p>

옛날에는 썰매에 그놈 깔아서 잘 썼지만 지금은 사실상 우분투 서버 깔린 상태나 다름이 없다는 것이다. (만약 실수로 sshd 날린다면 이 컴퓨터는 이제 쓸 수 없게 된다. -_-;) 아이피를 모르면 ssh조차 접속할 수 없기 때문에 이 컴퓨터는 부팅할 때마다 nsupdate를 써서 루리넷에 아이피를 바꿔 달라고 요청하도록 되어 있는데, 네트워크 구조가 바뀐 이후로는 자기 아이피를 못 알아내서(…) 아무 짓도 못 하고 있었다.


(일단의) 해결책
---------------

마침 오늘 아침에도 비슷한 상황이 벌어져서 복구를 좀 해 봤다. 어떻게 했는지 나중에 기억할 겸 써 둔다.

일단 이 놈의 아이피를 어떻게든 알아 내야 한다. 같은 서브네트워크에 물려 있기 때문에 가능한 아이피의 수는 많아도 256개를 못 넘고, 그 중에서 httpd가 켜져 있는 것은 극소수이므로 이 과정은 귀찮긴 해도 어렵진 않다. 대강 다음과 같은 명령을 쓴다.

	for ((i=1;i<256;++i)); do
	    echo -n "$i "; curl --connect-timeout 1 http://123.45.67.$i/
	done

이렇게 아이피를 알아 내면 ssh로 접속한다. ssh로 접속해서 w3m 같은 걸로 아무 데나 들어가 보면 모두 인증 페이지로 이동하는데, 자바스크립트가 안 되는 관계로(…) 자바스크립트를 사용한 redirect 페이지들은 모두 소스 보고 직접 이동해 줘야 한다.

이렇게 하다 보면 login.php였나 하는 페이지로 이동하는데, 여기서 아이디와 암호를 입력해야 하지만 w3m에서는 아이디 칸이 안 뜬다. 도대체 뭘 어떻게 해 뒀길래 아이디가 입력 안 되나 해서 보니까…

<p class="center">**input 엘리먼트에 `type="id"`로 하니까 안 뜨지!**</p>

(HTML을 잘 모르시는 분을 위한 설명: 우리가 늘상 보는 그 입력칸을 만들려면 `type="text"`로 지정해야 한다. 웬만한 브라우저는 이걸 잘 처리하지만 w3m은 그냥 무시해 버린다.)

결국 이 페이지를 다운로드해서 form 엘리먼트의 action 고치고 저 부분만 고쳐서 html로 저장한 뒤, w3m으로 수정된 페이지에 들어 가서 아이디 암호 치니 잘 되더라. -_-;

도대체 이건 HTML과 접근성과 인터넷 서비스의 기본도 안 된 인간들이 만든 건지 알 수가 없는데… 앞으로 썰매가 죽지 않길 바라는 수 밖에 없는 것 같다. 고약한 놈들이 약정으로 해 둬서 바꾸면 위약금 물어야 한다. orz

