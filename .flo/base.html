<%
contentlang = next.attr.lang or flo.lang or 'ko'
%>\
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="${contentlang|h}">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<meta http-equiv="Content-Language" content="${contentlang|h}"/>
	<title>${next.attr.title|h}</title>
	<meta name="author" content="Kang Seonghoon"/>
	<meta name="generator" content="${flo.generator|h}"/>
	<link rel="stylesheet" media="screen" href="/res/css/${next.attr.css|u,h}.css" type="text/css"/>
	<!--[if IE]><link rel="stylesheet" media="screen" href="/res/css/${next.attr.css|u,h}.ie.css" type="text/css"/><![endif]-->
	## dummy comment is to avoid singleton element created during DOM transformation.
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"><!--dummy--></script>
	<script type="text/javascript" src="/res/js/global.js"><!--dummy--></script>
</head>
<body>\
${self.header(contentlang)}\
<div id="content">\
${next.body()}\
<references/>\
</div>\
${self.footer(contentlang)}\
</body>
</html>

<%!
# default variables
lang = None
css = 'global'
title = u'메아리'
%>

<%def name="header(lang)">
% if lang == 'ko':
<p id="sitename"><a href="/"><img src="/res/img/logo.png" width="101" height="103" alt="메아리 처음으로" title="메아리 처음으로"/></a></p>
% else:
<p id="sitename"><a href="/"><img src="/res/img/logo.png" width="101" height="103" alt="Go to mearie.org front page." title="Go to mearie.org front page."/></a></p>
% endif
</%def>

<%def name="footer(lang)">
<div id="footer">
<%!
import subprocess
def gethgrev(path, tmpl):
	cmd = ['hg', 'log', '-ql1', '--template', tmpl, '--', path]
	return subprocess.Popen(cmd, stdout=subprocess.PIPE).communicate()[0]
%>
	<hr/>
% if flo.status == 200:
	<p class="pageinfo">${gethgrev(flo.path, 'Last modified in <strong>{date|isodate}</strong> | rev <strong>{node|short}</strong>')}</p>
% endif
	<p class="toolbar"><a href="${flo.url|h}/+tree">Tree view</a> | <a href="${flo.url|h}/+feed">Atom Feed</a> | <a href="${flo.url|h}/+response">Responses</a></p>
	<p class="copyright"><a href="/copyright">Copyright</a> &copy; 1999&ndash;2009, Kang Seonghoon. Some Rights Reserved.</p>
</div>
</%def>

## vim: set syn=mako: FLO_NOBASE
